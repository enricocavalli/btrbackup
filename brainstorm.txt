INIZIALIZZAZIONE FS

mkfs.btrfs /dev/sdb
mkdir /rsbackup
mount -o compress,noatime,nodiratime /dev/sdb /rsbackup

SUL CLIENT


groupadd rsbackup
useradd  -s /bin/bash -d /home/rsbackup -m -g rsbackup rsbackup


visudo
Cmnd_Alias RSYNC = /usr/bin/rsync
rsbackup ALL=(ALL) NOPASSWD: RSYNC

aggiustare hosts.allow e iptables se necessario

----


struttura filesystem
/rsbackup/bin/
/rsbackup/logs/


file di conf: 




/rsbackup/sito/macchina/.work
/rsbackup/sito/macchina/snap-`date`
/rsbackup/sito/legato/macchina



main idea: http://forums.freebsd.org/showthread.php?t=3689

---------------- NOTE SU INCLUSIONI ED ESCLUSIONI ----

Per quanto riguarda gli include, si possono backuppare solo certe parti di macchina, 
ad esempio

/etc/asterisk
/usr/local

backuppa quelle due sole directory. Per via delle opzioni files-from e dell'rsync che 
parte da / (tra mille virgolette), il tutto risulta sotto /rsbackup/macchina/etc/asterisk 
ovvero con percorso completo

Per le esclusioni, occhio alla diversit√†

voicemail/

voicemail/**

la prima non crea nemmeno la directory voicemail, la seconda crea la dir ma non backuppa niente

